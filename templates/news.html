{% extends "base.html" %}

{% block title %}Новости{% endblock %}

{% block content %}
<div class="container">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-container">
                {% for category, message in messages %}
                    <div class="flash flash-{{ category }}">
                        <span class="flash-dot"></span>
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Header Block -->
    <div class="news-page-header">
        <h1 class="page-title">Новости компании</h1>
        {% if session.pesel == "97021115999" %}
        <a href="{{ url_for('add_news') }}" class="btn btn-success">Добавить новость</a>
        {% endif %}
    </div>
    
    <!-- News List -->
    <div class="news-list">
        {% if news_list %}
            {% for article in news_list %}
            <a href="{{ url_for('view_news', article_id=article.id) }}" class="news-row">
                <div class="news-row-header">
                    <h3 class="news-row-title">{{ article.title }}</h3>
                    <span class="news-row-date">{{ article.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
                </div>
                <p class="news-row-description">{{ article.short_description }}</p>
                <div class="news-row-meta">
                    <span>От администратора</span>
                    {% if session.pesel == "97021115999" %}
                    <span class="admin-actions">
                        <a href="{{ url_for('edit_news', article_id=article.id) }}" class="btn-ghost">Редактировать</a>
                        <form method="POST" action="{{ url_for('delete_news', article_id=article.id) }}" style="display:inline;" onsubmit="return confirm('Вы уверены, что хотите удалить эту новость?');"><button type="submit" class="btn-ghost text-danger">Удалить</button></form>
                    </span>
                    {% endif %}
                </div>
            </a>
            {% endfor %}
        {% else %}
        <div class="empty-state">
            <p class="text-muted">На данный момент новостей нет.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
